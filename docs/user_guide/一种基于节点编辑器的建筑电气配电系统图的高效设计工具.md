本发明提供一种基于节点编辑器的建筑电气配电系统图的高效设计工具，属于计算机辅助设计技术领域，该工具通过直观的用户界面，集成了画布、工具栏和数据库，提供动态连接、双向数据流和高度交互性功能，它简化了设计流程，减少了在电流计算、断路器和线缆选型上的时间消耗，工具支持多种数据类型和格式，能够自动生成材料表和计算书，提高设计效率和准确性，配电回路节点和配电箱节点作为核心组件，集成了数学运算、逻辑判断和数据输入输出功能，并通过接触吸附机制优化用户交互体验，干线系统图节点自动映射配电系统设计，提供直观的系统布局视图。

![附图1](项目文档\media\附图1.png)

1.  一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于：包括以下步骤：

    1.  包括一个用户界面，该界面提供直观且灵活的操作环境，允许专业设计师专注于设计思路，从大局上进行配电系统的设计；

    2.  简化设计流程，减少在电流计算、保护设备和线缆选型等细节上的时间消耗；

    3.  具体组件包括画布、工具栏和数据库，其中：

        a.  画布用于展示绘图内容和工作区，提供动态连接和双向数据流功能；

        b.  工具栏提供多种设计和编辑工具，以及数据导出和材料表生成功能；

        c.  数据库支持多种数据类型和格式，用于存储和管理配电系统所需数据。

2.  根据权利要求1所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其画布特征在于：

    1.  动态连接功能，允许用户在节点间创建或取消连接，实现数据的实时更新；

    2.  双向数据流，支持数据在节点间的双向传递，实现复杂依赖关系和条件逻辑；

    3.  高度交互性，提供实时反馈，允许设计师通过拖放和连接操作进行设计。

3.  根据权利要求2所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括动态连接操作：

    1.  节点通过可配置的连接线或边相互连接，形成有序的数据流，支持数据的动态更新和数据流的实时调整。

4.  根据权利要求2所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括双向数据流：

    1.  动态数据流向：每个节点根据其功能和用户定义的连接关系，自动接收来自上游节点的数据，并根据这些数据执行相应的计算或操作，计算结果或更新后的数据随后自动流向下游节点，部分数据反馈给上游节点，确保整个系统的数据一致性和实时性；

    2.  信息同步：节点间的连接线不仅传输数据，还同步了各节点的状态和信息，这种同步机制保证了系统在任何时候都能反映最新的设计状态，提高了设计的准确性和可靠性；

    3.  自动更新：当用户对系统中的任何一个节点进行修改时，相关变更会自动沿着连接线传递到所有相关的节点，触发这些节点进行必要的更新，并以高亮或其他视觉提示的方式显示变更内容，这种自动更新机制显著减少了手动调整的需要，提高了设计效率；

    4.  灵活性与扩展性：节点之间的连接关系可以根据设计需求灵活调整，支持系统的扩展和修改，用户可以根据新的设计要求，重新配置节点间的连接，而不影响整个系统的稳定性；

    5.  用户界面反馈：用户界面提供直观的反馈，清晰显示每个节点的输入输出状态，这种可视化反馈帮助用户快速判断系统当前状态。

5.  根据权利要求2所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括高度交互性：

    1.  提供实时的节点交互功能，即拖放和连接操作，实现即时的可视化反馈和设计验证。

6.  根据权利要求1所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括数据库；

    1.  支持包括功率值、计算电流值、回路用途、线缆型号与规格、回路编号、断路器型号与规格、相序的数据类型；

    2.  支持浮点型和字符串型的数据格式。

7.  根据权利要求1所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括工具栏：

    1.  提供导出功能，支持pdf和dwg格式；

    2.  提供保存功能，支持独立格式保存；

    3.  提供材料表和计算书生成功能，自动统计并生成电气元器件、线缆等材料的详细列表，自动生成电流计算、断路器和线缆规格选型计算步骤并生成电子版计算书；

    4.  提供多种节点放置选项，包括配电回路节点、配电箱节点、干线系统图节点、图框节点；

8.  根据权利要求7所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括配电回路节点：

    1.  自动计算电流：用户输入功率参数后，节点自动执行电流计算，确保计算的精确性和效率；

    2.  智能选型：基于自动计算的电流值，节点参照内置或用户定义的电缆载流量及元器件整定值选型表，智能选择合适的元器件和线缆规格，从而减少了设计过程中的人为错误率；

    3.  回路用途识别：节点能够根据用户输入的回路用途，智能选择最适合的元器件类型和组合，以满足特定应用场景的需求；

    4.  操作简便：设计为可通过接触吸附机制自动对齐并集成到配电箱节点内，提高用户交互效率；

    5.  用户自定义选项：保留了根据个人设计需求选择元器件类型和组合的灵活性，使得节点不仅自动化而且用户友好；

        配电回路节点在整个系统中发挥着关键作用，首先，用户在进行拖放操作时，系统能够智能识别节点的类型和属性，自动适配相关的连接规则，确保操作的准确性和有效性，例如，当用户拖动一个配电回路节点时，系统会自动判断可连接的位置和对象，并在用户试图进行不恰当连接时给出明确的提示；

        其次，连接操作不仅简便快捷，而且具有高度的灵活性，用户可以轻松调整连接的位置和对象，以适应不同场景下的设计需求，比如说，在配电系统的设计过程中，用户可以根据设计时的需要，将配电回路节点从一个配电箱节点拖入另一个配电箱节点，也可以将任意一个配电回路节点拖动到其他两个配电回路节点的中间，其他配电回路节点自动移位；

        再者，实时的可视化反馈能够让用户清晰地看到每一个操作所带来的变化，当进行拖放和连接操作时，系统会即时更新各个节点的外观、参数显示等，让用户直观地了解到设计内容的改动变化，比如，连接成功后，相关节点会高亮显示，配电箱节点的电流、电压、元器件选型等参数会实时更新，配电回路节点的相序和回路编号也会实时更新；

        此外，设计验证功能能够实时检查设计的合理性和合规性，一旦发现不符合电气规范或设计要求的操作，系统会立即发出警告并提供修正建议，例如，如果用户设计的配电级数超过3级或更多，系统会及时提醒用户，并提供调整方案。

9.  根据权利要求1所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括配电箱节点：

    1.  包含配电回路节点接口、数据表格、前级保护设备、浪涌保护器、PE端子排，为配电箱节点的基本组成部分；

    2.  包含能耗监测、电气火灾监测、消防电源监测和消防切断模块，实现能耗监测系统图、电气火灾监测系统图、消防电源监测系统图和消防系统图的快速搭建；

    3.  包括三相平衡算法，用于实时的将配电回路的功率尽量平均分配给L1、L2、L3三个相序，减少了人工操作的复杂性和时间消耗；

    4.  包括自动编号功能，能够根据连接的配电回路节点自动按顺序编制回路编号，即便在设计过程中某个回路节点被移除或重新布局，系统仍能智能地维持编号的连续性和逻辑性；

    5.  配电箱节点在系统中的工作流程，前级配电箱节点通过其内部的配电回路节点接口与多个后级配电箱节点实现连接，其中每个配电回路节点接口都具备数据接收和转发的功能，这些连接通过系统的智能数据流向管理机制，确保了从后级到前级的数据一致性和准确性，在这一配电箱系统中，每个后级配电箱节点自动将其功率值通过这些连接线传递给前级配电箱节点，最前级配电箱节点接收并汇总所有与其相连的后级配电箱节点的功率值，这一汇总过程由系统自动完成，无需人工干预，从而确保了功率数据的实时更新和准确性，每个配电箱节点根据自身的功率值自动计算电流并智能选择进线保护设备电流整定值，并将整定值传递给前级配电箱节点。

10. 根据权利要求1所述的一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于，包括干线系统图节点：

    1.  自动映射功能，干线系统图节点能够自动将画布内所有配电箱节点及其内置模块映射成相应的干线系统图，这些包括配电干线图、能耗监测干线图、电气火灾监控干线图、消防电源监测干线图，确保每个配电箱节点的位置、负荷指标和楼层信息在干线系统图中准确表示；

    2.  智能识别与连线生成，干线系统图节点能够自动识别配电箱节点的进线类型，包括单电源进线和双电源进线，并基于这些信息自动生成正确的干线连线，从而确保整个设计工作的准确性和完整性。

    3.  

**一种基于节点编辑器的建筑电气配电系统图的高效设计工具**

**技术领域**

本发明属于计算机辅助设计技术领域，具体涉及一种基于节点编辑器的建筑电气配电系统图的高效设计工具。

**背景技术**

建筑电气配电系统是建筑物内电力供应和分配的关键组成部分，其功能是将电力安全有效地从外部电网传输至建筑内部的各个用电点位。在建筑内部，该系统通常包括多个有前后级关系的配电箱，箱内装配有多种元器件，如保护设备（断路器、隔离开关、双电源转换开关、浪涌保护器等）、监测模块（电气火灾监控、消防电源监测、电能计量等）和二次控制回路等。在配电系统的设计图纸中，配电箱里的这些元器件通过图例加文字的形式来表达，配电箱的进出线缆规格型号也通过线条加文字的形式来表达，而配电箱的负荷指标等关键信息则通过由线条绘制的表格来表示。

现有的配电系统图的设计主要依赖于计算机辅助设计软件（CAD），该方法涉及使用独立的图形和文字来表达元器件甚至是整个配电箱系统。然而，这种方法存在若干缺点：

1.  手动更新繁琐：当配电回路的功率值需要更改时，保护设备和线缆的选型无法自动调整，需要设计师手动依次对配电回路，按步骤重复地进行先计算后选型的一系列操作，这些操作步骤繁多，增加了出错的几率。

2.  前后级联动更新困难：后级配电箱的变更不能自动反映到前级配电箱系统图中，导致设计师必须逐级手动调改，这一过程需要考虑保护设备的前后级选择性和其他的一些条件，不仅耗时，而且容易出错。

3.  对照复杂：设计师需要不断参照元器件和电缆选型手册，以确保选型的正确性，这使得设计师需要来回查阅资料，比较复杂和繁琐。

4.  干线系统图同步问题：配电箱功率值的更新以及配电系统架构的调整还需同步至干线系统图中，这一步骤同样需要设计师手动前后对照操作，增加了设计过程中的工作量和出错几率。

5.  计算及选型结果的输出问题：设计过程中，设计师需要进行简单而重复的计算和选型工作，并将结果手动整合到一个负荷一览表中，设计师还需要再次将这些整合后的数据手动加上计算过程后编写成计算书，这一步骤通常涉及到额外的数据校验和誊写工作，增加了编写计算书的出错几率。

6.  效率低下：特别是在大型或复杂的建筑电气配电设计项目中，设计过程中输入的条件种类繁多且会反复调整，由于配电设计需要及时跟进，现有设计方法依赖于手动操作，其效率不足的问题尤为突出，显著降低了设计工作的总体效率。

**发明内容**

本发明的目的在于提供一种基于节点编辑器的建筑电气配电系统图的高效设计工具，通过创新的模块化和可视化方法，简化电气配电系统图的设计过程，让设计师根据自己的设计思路，快速搭建配电系统图架构并细化，旨在解决上述提出的问题。

1.  为实现上述目的，本发明提供如下技术方案：

    一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于：包括以下步骤：

    1.  包括一个用户界面，该界面提供直观且灵活的操作环境，允许专业设计师专注于设计思路，从大局上进行配电系统的设计；

    2.  简化设计流程，减少在电流计算、保护设备和线缆选型等细节上的时间消耗；

    3.  具体组件包括画布、工具栏和数据库，其中：

        a.  画布用于展示绘图内容和工作区，提供动态连接和双向数据流功能；

        b.  工具栏提供多种设计和编辑工具，以及数据导出和材料表生成功能；

数据库支持多种数据类型和格式，用于存储和管理配电系统所需数据。

1.  作为本发明一种优选的方案，其画布特征在于：

    1.  动态连接功能，允许用户在节点间创建或取消连接，实现数据的实时更新；

    2.  双向数据流，支持数据在节点间的双向传递，实现复杂依赖关系和条件逻辑；

    3.  高度交互性，提供实时反馈，允许设计师通过拖放和连接操作进行设计。

2.  作为本发明一种优选的方案，包括动态连接操作：

    1.  节点通过可配置的连接线或边相互连接，形成有序的数据流，支持数据的动态更新和数据流的实时调整。

3.  作为本发明一种优选的方案，包括双向数据流：

    1.  动态数据流向：每个节点根据其功能和用户定义的连接关系，自动接收来自上游节点的数据，并根据这些数据执行相应的计算或操作，计算结果或更新后的数据随后自动流向下游节点，部分数据反馈给上游节点，确保整个系统的数据一致性和实时性；

    2.  信息同步：节点间的连接线不仅传输数据，还同步了各节点的状态和信息，这种同步机制保证了系统在任何时候都能反映最新的设计状态，提高了设计的准确性和可靠性；

    3.  自动更新：当用户对系统中的任何一个节点进行修改时，相关变更会自动沿着连接线传递到所有相关的节点，触发这些节点进行必要的更新，并以高亮或其他视觉提示的方式显示变更内容，这种自动更新机制显著减少了手动调整的需要，提高了设计效率；

    4.  灵活性与扩展性：节点之间的连接关系可以根据设计需求灵活调整，支持系统的扩展和修改，用户可以根据新的设计要求，重新配置节点间的连接，而不影响整个系统的稳定性；

    5.  用户界面反馈：用户界面提供直观的反馈，清晰显示每个节点的输入输出状态，这种可视化反馈帮助用户快速判断系统当前状态。

4.  作为本发明一种优选的方案，包括高度交互性：

    1.  提供实时的节点交互功能，即拖放和连接操作，实现即时的可视化反馈和设计验证。

5.  作为本发明一种优选的方案，包括数据库：

    1.  持包括功率值、计算电流值、回路用途、线缆型号与规格、回路编号、断路器型号与规格、相序的数据类型；

    2.  支持浮点型和字符串型的数据格式。

6.  作为本发明一种优选的方案，包括工具栏：

    1.  提供导出功能，支持pdf和dwg格式；

    2.  提供保存功能，支持独立格式保存；

    3.  提供材料表和计算书生成功能，自动统计并生成电气元器件、线缆等材料的详细列表，自动生成电流计算、断路器和线缆规格选型计算步骤并生成电子版计算书；

    4.  提供多种节点放置选项，包括配电回路节点、配电箱节点、干线系统图节点、图框节点；

7.  作为本发明一种优选的方案，包括配电回路节点：

    1.  自动计算电流：用户输入功率参数后，节点自动执行电流计算，确保计算的精确性和效率；

    2.  智能选型：基于自动计算的电流值，节点参照内置或用户定义的电缆载流量及元器件整定值选型表，智能选择合适的元器件和线缆规格，从而减少了设计过程中的人为错误率；

    3.  回路用途识别：节点能够根据用户输入的回路用途，智能选择最适合的元器件类型和组合，以满足特定应用场景的需求；

    4.  操作简便：设计为可通过接触吸附机制自动对齐并集成到配电箱节点内，提高用户交互效率；

    5.  用户自定义选项：保留了根据个人设计需求选择元器件类型和组合的灵活性，使得节点不仅自动化而且用户友好；

        配电回路节点在整个系统中发挥着关键作用，首先，用户在进行拖放操作时，系统能够智能识别节点的类型和属性，自动适配相关的连接规则，确保操作的准确性和有效性，例如，当用户拖动一个配电回路节点时，系统会自动判断可连接的位置和对象，并在用户试图进行不恰当连接时给出明确的提示；

        其次，连接操作不仅简便快捷，而且具有高度的灵活性，用户可以轻松调整连接的位置和对象，以适应不同场景下的设计需求，比如说，在配电系统的设计过程中，用户可以根据设计时的需要，将配电回路节点从一个配电箱节点拖入另一个配电箱节点，也可以将任意一个配电回路节点拖动到其他两个配电回路节点的中间，其他配电回路节点自动移位；

        再者，实时的可视化反馈能够让用户清晰地看到每一个操作所带来的变化，当进行拖放和连接操作时，系统会即时更新各个节点的外观、参数显示等，让用户直观地了解到设计内容的改动变化，比如，连接成功后，相关节点会高亮显示，配电箱节点的电流、电压、元器件选型等参数会实时更新，配电回路节点的相序和回路编号也会实时更新；

        此外，设计验证功能能够实时检查设计的合理性和合规性，一旦发现不符合电气规范或设计要求的操作，系统会立即发出警告并提供修正建议，例如，如果用户设计的配电级数超过3级或更多，系统会及时提醒用户，并提供调整方案。

8.  作为本发明一种优选的方案，包括配电箱节点：

    1.  包含配电回路节点接口、数据表格、前级保护设备、浪涌保护器、PE端子排，为配电箱节点的基本组成部分；

    2.  包含能耗监测、电气火灾监测、消防电源监测和消防切断模块，实现能耗监测系统图、电气火灾监测系统图、消防电源监测系统图和消防系统图的快速搭建；

    3.  包括三相平衡算法，用于实时的将配电回路的功率尽量平均分配给L1、L2、L3三个相序，减少了人工操作的复杂性和时间消耗；

    4.  包括自动编号功能，能够根据连接的配电回路节点自动按顺序编制回路编号，即便在设计过程中某个回路节点被移除或重新布局，系统仍能智能地维持编号的连续性和逻辑性；

    5.  配电箱节点在系统中的工作流程，前级配电箱节点通过其内部的配电回路节点接口与多个后级配电箱节点实现连接，其中每个配电回路节点接口都具备数据接收和转发的功能，这些连接通过系统的智能数据流向管理机制，确保了从后级到前级的数据一致性和准确性，在这一配电箱系统中，每个后级配电箱节点自动将其功率值通过这些连接线传递给前级配电箱节点，最前级配电箱节点接收并汇总所有与其相连的后级配电箱节点的功率值，这一汇总过程由系统自动完成，无需人工干预，从而确保了功率数据的实时更新和准确性，每个配电箱节点根据自身的功率值自动计算电流并智能选择进线保护设备电流整定值，并将整定值传递给前级配电箱节点。

9.  作为本发明一种优选的方案，包括干线系统图节点：

    1.  自动映射功能，干线图节点能够自动将画布内所有配电箱节点及其内置模块映射成相应的干线系统图，这些包括配电干线图、能耗监测干线图、电气火灾监控干线图、消防电源监测干线图，确保每个配电箱节点的位置、负荷指标和楼层信息在干线系统图中准确表示；

    2.  智能识别与连线生成，干线图节点能够自动识别配电箱节点的进线类型，包括单电源进线和双电源进线，并基于这些信息自动生成正确的干线连线，从而确保整个设计工作的准确性和完整性；

10. 与现有技术相比，本发明的有益效果是：

    1.  模块化设计方法：本发明摒弃了传统的零散型图元和图块设计方式，转而采用基于节点的模块化设计方法。配电系统中的各个组成部分，如配电回路、配电箱、干线等，均被设计为独立的模块节点，每个节点封装了特定的功能和属性。不仅简化了设计过程，而且增强了设计的适应性和灵活性。

    2.  节点编辑器应用：利用节点编辑器的直观操作方式，用户可以通过拖拽和连接这些模块节点来构建配电系统，进一步简化了设计流程，提高了设计的交互性和动态调整的便捷性。

    3.  自动化电流计算与选型：配电回路节点和配电箱节点具备自动电流计算功能，能够根据用户输入的参数智能完成元器件和线缆的选型，显著减少了设计过程中的手动计算与选型工作。

    4.  智能编号与三相平衡：配电箱节点能够自动为连接的回路节点编号，并根据功率自动分配相序，系统提高了工作效率，降低了人为错误的可能性。

    5.  实时反馈与自动更新：本发明的系统能够实时响应设计调整，自动更新相关节点的数据和显示，确保了设计的一致性和准确性。

    6.  自动识别与连线生成：干线系统图节点能够自动识别配电箱节点的关键信息，并根据这些信息自动生成干线连线，减少了手动绘图的需求，提高了设计效率。

    7.  用户自定义节点支持：本发明特别提供了用户自定义节点的功能，允许用户根据特定需求创建新的节点类型，增强了设计的个性化和灵活性。

    8.  用户界面与交互优化：用户界面友好，交互直观，使得专业设计师能轻松进行复杂的电气配电系统设计。

    9.  提高设计重用性：模块化的设计方法提高了设计的重用性，用户可以轻松修改、替换或重用现有节点，以适应不同的设计需求。

    10. 设计流程的简化：通过自动化和智能化的设计工具，本发明简化了设计流程，缩短了设计周期，同时降低了设计过程中的错误率。

**附图说明**

附图用来提供对本发明的进一步理解，并且构成说明书的一部分，与本发明的实施例一起用于解释本发明，并不构成对本发明的限制。在附图中：

图1为本发明中用户界面布局框图；

图2为本发明中三相配电回路节点工作原理框图；

图3为本发明中单相配电回路节点工作原理框图；

图4为本发明中配电箱节点工作原理框图；

图5为本发明中配电回路节点和配电箱节点的关系框图；

图6为本发明中配电箱节点与干线系统图节点的关系框图；

图7为本发明中配电箱节点的自动编号功能工作原理流程图；

图8为本发明中配电箱节点的三相平衡分配算法流程图；

图9为本发明中自动计算电流工作原理流程图；

图10为本发明中三相配电回路节点自动选型工作原理流程图；

图11为本发明中配电箱节点自动选型工作原理流程图；

图12为本发明中配电系统的两种局部架构及关系框图。

**具体实施方式**

下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。

**实施例1**

从图1的界面布局中找到【配电回路节点】按钮，点击并将图3的【单相配电回路节点】拖动到画布中；找到图4的【配电箱节点】按钮，点击并拖动到画布中；将【单相配电回路节点】通过按住鼠标左键拖动到【配电箱节点】里的【连接点】附近，【连接点】自动吸附，松开鼠标，建立连接关系；复制多个【单相配电回路节点】，均与此【配电箱节点】建立连接，【配电箱节点】自动执行数据运算和信息传递，至此，带【单相配电回路节点】的单个【配电箱节点】架构简单搭建完毕，如图4。

同理，搭建一个简单的带【三相配电回路节点】的【配电箱节点】，作为前级。

将上述带【单相配电回路节点】的【配电箱节点】复制多个，作为后级；在后级【配电箱节点】的前端按住鼠标左键，拖出一根线，移动到前级【配电箱节点】的【三相配电回路节点】的后端，松开鼠标，建立连接关系；其余后级【配电箱节点】均按此操作连接至前级【配电箱节点】，至此，一个简易的配电系统图架构搭建完毕，如图5。

将【干线系统图节点】拖入布局中，同上述操作方法，将【配电箱节点】的前端与【干线系统图节点】的输入端相连，【干线系统图节点】中随即展现出配电干线系统图、电气火灾监控系统图、消防电源监控系统图；配电干线系统图体现了配电系统的拓扑结构，包含了配电箱的编号、功率值、所在楼层位置等信息；电气火灾监控系统图和消防电源监控系统图体现了监测系统的拓扑结构，包含了监测模块所在楼层位置等信息。

验证改动产生的效果，随意修改后级【配电箱节点】的【单相配电回路节点】的功率值，前级【配电箱节点】功率值随即发生变化；随意断开一个后级【配电箱节点】与前级的连线，后级【配电箱节点】中的数据信息保持不变，前级【配电箱节点】数据信息随即发生改变；随意删除一个【单相配电回路节点】，或者将【单相配电回路节点】拖动至其他后级【配电箱节点】，又或者新增一个【单相配电回路节点】至任意一个后级【配电箱节点】，【配电箱节点】均自动进行回路编号与相序的更新。改动【配电箱节点】中编号的楼层数字，【干线系统图节点】中的配电干线系统图拓扑结构发生变化，配电箱所在楼层位置发生改变；随意增加或删除【配电箱节点】中的【监测模块】，【干线系统图节点】中的监测系统拓扑结构发生变化。

1.  请参阅图1-图12，本发明提供以下技术方案：

    1.  一种基于节点编辑器的建筑电气配电系统图的高效设计工具，其特征在于：包括以下步骤：

        a.  包括一个用户界面，该界面提供直观且灵活的操作环境，允许专业设计师专注于设计思路，从大局上进行配电系统的设计；

        b.  简化设计流程，减少在电流计算、保护设备和线缆选型等细节上的时间消耗；

        c.  具体组件包括画布、工具栏和数据库，其中：

            1.  画布用于展示绘图内容和工作区，提供动态连接和双向数据流功能；

            2.  工具栏提供多种设计和编辑工具，以及数据导出和材料表生成功能；

            3.  数据库支持多种数据类型和格式，用于存储和管理配电系统所需数据。

2.  在本发明的具体实施例中：

    1.  模块化设计：

        a.  本发明将配电回路、配电箱系统图和干线系统图设计为独立的模块，类比于节点编辑器中的节点，每个模块（节点）负责特定的功能，如功率计算、元器件和线缆选型、各系统的拓扑结构表示等。

        b.  允许用户根据特定的设计需求和偏好，创建新的节点类型和功能。

    2.  用户界面与交互：

        a.  用户通过拖拽操作在虚拟画布上创建和布局这些模块，并且可以通过连接2个模块来实现数据传递，类比于节点编辑器中的连线方式。

    3.  节点功能与操作：

        a.  配电回路节点：该节点是一个高度自动化的功能模块，核心功能包括：

            1.  自动计算电流：用户输入功率参数后，节点自动执行电流计算，并展示计算结果以及1.1倍和1.25倍的计算结果，以供用户参考。

            2.  智能选型：基于自动计算的电流值，节点参照内置或用户定义的电缆载流量及元器件整定值选型表，智能选择合适的元器件和线缆规格，从而减少了设计过程中的人为错误率。

            3.  回路用途识别：节点能够根据用户输入的回路用途，智能判断并选择最适合的元器件类型和组合，以提高设计效率。

            4.  操作简便：本节点为可通过接触吸附机制自动对齐并集成到配电箱节点内，提高用户交互效率。

            5.  用户自定义选项：保留了根据个人设计需求选择元器件类型和组合的灵活性，使得节点不仅自动化而且用户友好。

        b.  配电箱节点：除了具备与配电回路节点相同的自动电流计算功能外，该节点还具备以下功能：

            1.  自动编号：能够根据连接的配电回路节点自动按顺序编制回路编号，即便在设计过程中某个回路节点被移除或重新布局，系统仍能智能地维持编号的连续性和逻辑性。

            2.  三相平衡分配：本节点能够按特定算法，根据各回路节点的功率自动分配相序，当出线回路数量达到二十条以上时，这一功能显著减少了人工操作的复杂性和时间消耗。

        c.  干线系统图节点：该节点能够根据所连接的配电箱节点的编号逻辑和负荷指标，自动识别每个配电箱所在的楼层以及配电箱的功率。此外，该节点还具备以下功能：

            1.  自动映射功能：干线系统图节点能够自动将画布内所有配电箱节点及其内置模块映射成相应的干线系统图，这些包括配电干线图、能耗监测干线图、电气火灾监控干线图、消防电源监测干线图，确保每个配电箱节点的位置、负荷指标和楼层信息在干线系统图中准确表示。

            2.  智能识别与连线生成：干线系统图节点能够自动识别配电箱节点的进线类型，包括单电源进线和双电源进线，并基于这些信息自动生成正确的干线连线，从而确保整个设计工作的准确性和完整性。

    4.  数据流向与连接：

        a.  允许系统中的所有节点通过连接线进行相互连接，这种连接不仅是数据传递的通道，也是实现模块间信息同步和动态更新的关键，包括以下功能：

            1.  动态数据流向：每个节点根据其功能和用户定义的连接关系，自动接收来自上游节点的数据，并根据这些数据执行相应的计算或操作，计算结果或更新后的数据随后自动流向下游节点，确保整个系统的数据一致性和实时性。

            2.  信息同步：节点间的连接线不仅传输数据，还同步了各节点的状态和信息，这种同步机制保证了系统在任何时候都能反映最新的设计状态，提高了设计的准确性和可靠性。

            3.  自动更新：当用户对系统中的任何一个节点进行修改时，相关变更会自动沿着连接线传递到所有相关的节点，触发这些节点进行必要的更新，并以高亮或其他视觉提示的方式显示变更内容。这种自动更新机制显著减少了手动调整的需要，提高了设计效率。

            4.  灵活性与扩展性：节点之间的连接关系可以根据设计需求灵活调整，支持系统的扩展和修改。用户可以根据新的设计要求，重新配置节点间的连接，而不影响整个系统的稳定性。

            5.  用户界面反馈：用户界面提供直观的反馈，清晰显示每个节点的输入输出状态。这种可视化反馈帮助用户快速判断系统当前状态。

    5.  实时反馈与自动更新：

        a.  用户在调整节点参数或连接关系时，系统能够根据输入数据自动完成计算，并提供实时的结果反馈，确保设计的准确性和及时性。

    6.  自动化设计流程：

        a.  本工具利用节点编辑器的数据处理机制，实现了设计流程的自动化，减少了手动计算和更新的需求，从而显著提高了设计效率。

3.  本发明提出了多项创新，具体包括：

    1.  模块化设计方法：本发明采用基于节点的模块化设计方法，将配电系统细分为功能封装的独立模块节点，每个节点封装特定的功能、属性和运算逻辑，提高了设计的可维护性和扩展性。

        a.  保护点：模块化方法允许快速修改和替换，确保了设计的灵活性和简便性。

    2.  节点编辑器应用：利用节点编辑器的直观操作，用户通过拖拽和连接模块节点构建配电系统，简化了用户操作流程，显著提升了用户体验。

        a.  保护点：节点编辑器的直观操作方式极大地简化了配电系统设计构建过程，提升了设计的灵活性。

    3.  自动化电流计算与选型：配电回路节点和配电箱节点实现自动电流计算，智能完成元器件和线缆的选型，确保了计算的准确性，减少了设计错误率。

        a.  保护点：自动算法确保了电流计算和元器件选型的高效率和准确性，减少了手动计算的需求。

    4.  智能编号与三相平衡：配电箱节点为配电回路节点自动编号并根据功率给配电回路节点自动分配相序，减少了人工操作的复杂性。

        a.  保护点：自动编号系统适应节点变更，简化操作。

        b.  保护点：自动相序分配算法快速实现系统三相平衡，减少耗时。

    5.  实时反馈与自动更新：系统实时响应设计变更，自动更新相关节点数据和显示，确保了设计的一致性和准确性。

        a.  保护点：实时更新机制保障了设计信息的同步，确保数据一致性和准确性。

    6.  自动识别与连线生成：干线系统图节点自动识别配电箱节点信息，自动生成干线连线，减少了设计错误并加快了设计流程。

        a.  保护点：自动识别和连线生成减少了手动绘图的需求，提高了设计的精确度。

    7.  用户自定义节点支持：提供用户自定义节点功能，允许根据项目特定需求创建新的节点类型，满足个性化解决方案的需求。

        a.  保护点：用户自定义节点支持了设计的个性化和灵活性，适应了多样化的应用场景。

    8.  用户界面与交互优化：用户界面友好，交互直观，使得专业设计师能轻松进行复杂的电气配电系统设计。

        a.  保护点：优化的用户界面和交互设计提升了用户体验，降低了操作难度。

    9.  数据流向与连接机制：定义清晰的数据流向和同步机制，通过连接线实现信息的实时更新和准确性。

        a.  保护点：数据流向和连接机制确保了信息的准确性和时效性，增强了系统响应能力。

    10. 设计流程的简化：通过自动化和智能化工具简化设计流程，缩短设计周期，降低错误率，提高项目成本效益。

        a.  保护点：设计流程的简化直接影响项目的时间和成本，提升了设计效率。

    11. 自动更新机制：节点修改后，系统自动更新相关节点，保持设计的同步性和连贯性。

        a.  保护点：自动更新机制确保了设计在整个项目中的一致性。

    12. 高设计重用性：模块化设计提高了重用性，用户可以在新项目中轻松修改、替换或重用现有节点，以适应不同的设计需求。

        a.  保护点：设计重用性节约了资源，加速了新项目的设计过程，提高了设计资源的利用效率。

本发明的这些创新点共同作用，为用户提供了一个高效、准确、易于使用的建筑电气配电系统设计工具，具有显著的市场应用潜力和技术创新价值。

4.  本发明的关键点：

    1.  模块化设计：本发明将配电系统设计分解为独立的模块（节点），每个模块负责特定功能，如电流计算、元器件和线缆选型，实现设计的标准化和快速适应性。

    2.  节点编辑器应用：使用节点编辑器的直观操作方式，允许用户通过拖拽和连接模块节点构建配电系统，提供用户友好的交互界面，支持复杂设计任务。

    3.  自动化电流计算：配电回路节点和配电箱节点具备自动电流计算功能，能够根据计算电流值和用户输入的参数智能完成元器件和线缆的选型，提高设计精度和效率。

    4.  智能编号与三相平衡：配电箱节点自动为连接的回路节点编号，并根据功率自动分配相序，确保三相系统的负载均衡，简少设计时间。

    5.  实时反馈与自动更新：系统能够实时响应设计变更，自动更新相关节点的数据和显示，确保设计的一致性和准确性。

    6.  自动识别与连线生成：干线系统图节点自动识别配电箱节点的关键信息，并根据这些信息自动生成干线连线，减少手动绘图需求，提高设计效率。

    7.  用户自定义节点：允许用户根据特定需求创建新的节点类型，增强设计的个性化和灵活性，满足特定项目需求。

    8.  数据流向与连接：节点间通过连接线相互连接，定义数据流向，实现模块间信息同步和更新，确保数据的准确性和可靠性。

    9.  自动更新机制：用户对节点的修改自动传递并更新相关节点，提高设计效率，确保设计在整个项目中的连贯性和适应性。

5.  附图说明：

    1.  附图1展示了工具的用户界面布局，包括画布、节点库和参数配置面板。

    2.  附图2详细描述了三相配电回路节点的内部结构和工作原理。

    3.  附图3详细描述了单相配电回路节点的内部结构和工作原理。

    4.  附图4详细描述了配电箱节点的内部结构和工作原理。

    5.  附图5展示了配电回路节点和配电箱节点之间的连接关系和数据流向。

    6.  附图6展示了配电箱节点与干线系统图节点之间的连接关系和数据流向。

    7.  附图7详细描述了配电箱节点的自动编号功能的工作原理。

    8.  附图8详细描述了配电箱节点的三相平衡分配功能的算法原理，其步骤如下：

        a.  初始化分配：将配电回路节点中的功率值按顺序分配到相序L1、L2、L3；

        b.  计算各相序总和：分别计算每个相序L1、L2、L3的功率值总和，得到S1、S2、S3；

        c.  计算总和与平均值：计算所有功率值的总和S。计算平均功率值Se =
            S/3；

        d.  计算差值：分别计算S1、S2、S3与Se的差值，得到ΔS1、ΔS2、ΔS3；

        e.  平衡调整判断：对于每个ΔSi（i = 1, 2,
            3），检查是否需要调整以使各相序总和接近Se；

        f.  执行数值转移：从ΔSi为正的相序中选择适当的功率值，转移到ΔSi为负的相序，以减少差值；

        g.  迭代优化：重复步骤d至f，直到无法进一步减小各相序总和与平均值Se之间的差异；

        h.  输出最终分配：输出最终每个相序L1、L2、L3的功率值分配及其总和。

    9.  附图9详细描述了自动计算电流的工作原理。

    10. 附图10展示了三相配电回路节点自动选择元器件和线缆型号规格的详细工作原理，其流程如下：

        a.  电流值计算：接收上游节点传递的功率值，并据此计算得到计算电流值；

        b.  元器件选型：

            1.  利用计算电流值，查询电缆载流量及元器件整定值选型表；

            2.  根据选型表和上游节点提供的电流整定值，确定本节点的元器件电流整定值；

            3.  元器件壳架电流值选择为大于电流整定值的最近固定档位；

            4.  三相回路的级数采用固定值；

            5.  元器件型号依据国家通用标准型号或用户预设的特定产品型号进行选择；

        c.  线缆选型：

            1.  使用电流整定值查询电缆载流量及元器件整定值选型表，以确定相应的线缆规格和穿管规格；

            2.  线缆型号的选择遵循国家规范要求；

            3.  电压等级基于选定的线缆型号确定；

            4.  敷设方式默认设置一个初始值，但需用户根据项目实际情况进行调整；

        d.  数据传递：将计算得到的元器件电流整定值和回路功率等关键数据传递给下游节点，用以下游节点的元器件选型。

    11. 附图11展示了配电箱节点自动选择元器件的详细工作原理，流程如下：

        a.  接收上游数据：接收与本节点连接的所有上游配电回路节点提供的元器件电流整定值和功率值；

        b.  计算总功率和电流：将所有接收到的功率值相加，得到配电箱的总功率值。根据总功率值，计算得到配电箱的计算电流值；

        c.  确定进线保护设备规格：参照选型表和上游节点提供的电流整定值，以及规范要求，确定进线保护设备的电流整定值；

        d.  确定其他元器件参数：根据进线保护设备的电流整定值，设定消防电源监控和电气火灾监控等模块的动作电流值；

        e.  数据传递：将计算得到的进线保护设备的电流整定值、配电箱总功率值和配电箱名称等关键数据传递给下游节点。

    12. 附图12展示了配电系统的两种局部架构和主要组件，以及它们之间的关系。

最后应说明的是：以上所述仅为本发明的优选实施例而已，并不用于限制本发明，尽管参照前述实施例对本发明进行了详细的说明，对于本领域的技术人员来说，其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换。凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。

![附图1](项目文档\media\附图1.png)

图1

![附图2](项目文档\media\附图2.png)

图2

![附图3](项目文档\media\附图3.png)

图3

![附图4](项目文档\media\附图4.png)

图4

![附图5](项目文档\media\附图5.png)

图5

![附图6](项目文档\media\附图6.png)

图6

![附图7](项目文档\media\附图7.png)

图7

![附图8](项目文档\media\附图8.png)

图8

![附图9](项目文档\media\附图9.png)

图9

![附图10](项目文档\media\附图10.png)

图10

![附图11](项目文档\media\附图11.png)

图11

![附图12](项目文档\media\附图12.png)

图12
